"use strict";(self.webpackChunkprenzavier01_github_io=self.webpackChunkprenzavier01_github_io||[]).push([[656],{7656:(x,v,r)=>{r.r(v),r.d(v,{Module:()=>q});var b=r(1368),f=r(3660),c=r(940),C=r(1780),t=r(4496),s=r(1296);let E=(()=>{class e{constructor(){}ngOnInit(){}static \u0275fac=function(a){return new(a||e)};static \u0275cmp=t.In1({type:e,selectors:[["app-layout"]],decls:3,vars:0,consts:[[1,"content"]],template:function(a,o){1&a&&(t.wR5(0,"app-breadcrumb"),t.I0R(1,"section",0),t.wR5(2,"router-outlet"),t.C$Y())},dependencies:[c.cP,s.a]})}return e})();var g=r(2328),O=r(5016),S=r(8768),T=r(7176),R=r(460),_=r(3064),G=r(5584),u=r(6088),i=r(2532),l=r(268),d=r(4604),h=r(2080),Y=r(4716);function F(e,p){if(1&e&&t.wR5(0,"nz-option",8),2&e){const n=p.$implicit;t.E7m("nzValue",n.id)("nzLabel",n.firstName+" "+n.lastName)}}function L(e,p){1&e&&(t.I0R(0,"div",9)(1,"div",10)(2,"div",11),t.wR5(3,"span",12),t.I0R(4,"h4"),t.OEk(5,"Select A Borrower"),t.C$Y()()()())}function B(e,p){1&e&&(t.I0R(0,"div",1)(1,"div",10)(2,"div",11)(3,"h4"),t.OEk(4,"No Loans associated with this borrower!"),t.C$Y()()()())}function w(e,p){if(1&e&&(t.I0R(0,"div",35),t.OEk(1),t.C$Y()),2&e){const n=p.$implicit,a=p.index;t.yG2(),t.CAO("Check No. ",a+1,": ",n.chequeNumber," ")}}function U(e,p){if(1&e&&(t.I0R(0,"nz-descriptions-item",33)(1,"div",1),t.yuY(2,w,2,2,"div",34),t.C$Y()()),2&e){const n=t.GaO(2);t.yG2(2),t.E7m("ngForOf",null==n.loan?null:n.loan.chequeNumbers)}}function j(e,p){if(1&e){const n=t.KQA();t.I0R(0,"button",39),t.qCj("click",function(){t.usT(n);const o=t.GaO().$implicit,m=t.GaO(2);return t.CGJ(m.openPayment(o))}),t.OEk(1,"PAY IN FULL"),t.C$Y()}if(2&e){const n=t.GaO().index,a=t.GaO(2);t.E7m("disabled",n>0&&"Paid"!=a.schedules[n-1].status)}}function K(e,p){if(1&e){const n=t.KQA();t.I0R(0,"button",39),t.qCj("click",function(){t.usT(n);const o=t.GaO().$implicit,m=t.GaO(2);return t.CGJ(m.confirmPayment(o))}),t.OEk(1,"CONFIRM PAYMENT"),t.C$Y()}if(2&e){const n=t.GaO().index,a=t.GaO(2);t.E7m("disabled",n>0&&"Paid"!=a.schedules[n-1].status)}}function Q(e,p){1&e&&(t.I0R(0,"button",40),t.OEk(1,"PAYMENT DETAILS"),t.C$Y())}function V(e,p){if(1&e){const n=t.KQA();t.I0R(0,"button",39),t.qCj("click",function(){t.usT(n);const o=t.GaO().$implicit,m=t.GaO(2);return t.CGJ(m.restructurePayment(o))}),t.OEk(1,"RESTRUCTURE"),t.C$Y()}if(2&e){const n=t.GaO().index,a=t.GaO(2);t.E7m("disabled",n>0&&"Unpaid"==a.schedules[n-1].status)}}function H(e,p){if(1&e&&(t.I0R(0,"tr")(1,"td",11),t.OEk(2),t.C$Y(),t.I0R(3,"td",11),t.OEk(4),t.C$Y(),t.I0R(5,"td",11),t.OEk(6),t.C$Y(),t.I0R(7,"td",11),t.OEk(8),t.C$Y(),t.I0R(9,"td",11),t.OEk(10),t.C$Y(),t.I0R(11,"td",11),t.OEk(12),t.C$Y(),t.I0R(13,"td",36),t.yuY(14,j,2,1,"button",37)(15,K,2,1,"button",37)(16,Q,2,0,"button",38)(17,V,2,1,"button",37),t.C$Y()()),2&e){const n=p.$implicit,a=p.index,o=t.GaO(2);t.yG2(2),t.cNF(a+1),t.yG2(2),t.cNF(n.dueDate),t.yG2(2),t.oRS("\u20b1 ",o.formatCurrency(n.amountDue),""),t.yG2(2),t.cNF(n.penaltyDays),t.yG2(2),t.oRS("\u20b1 ",o.formatCurrency(n.penaltyFee),""),t.yG2(2),t.cNF(n.status?n.status:"Unpaid"),t.yG2(2),t.E7m("ngIf","PDC"!=o.loan.modeOfPayment&&"Paid"!=n.status),t.yG2(),t.E7m("ngIf","PDC"==o.loan.modeOfPayment&&"Paid"!=n.status),t.yG2(),t.E7m("ngIf","Paid"==n.status),t.yG2(),t.E7m("ngIf","Paid"!=n.status)}}function X(e,p){if(1&e&&(t.SAx(0),t.I0R(1,"div",9)(2,"div",10)(3,"nz-descriptions",13)(4,"nz-descriptions-item",14),t.OEk(5),t.C$Y(),t.I0R(6,"nz-descriptions-item",15),t.OEk(7),t.C$Y(),t.I0R(8,"nz-descriptions-item",16),t.OEk(9),t.C$Y(),t.I0R(10,"nz-descriptions-item",17),t.OEk(11),t.C$Y(),t.I0R(12,"nz-descriptions-item",18),t.OEk(13),t.C$Y(),t.I0R(14,"nz-descriptions-item",19),t.OEk(15),t.C$Y(),t.I0R(16,"nz-descriptions-item",20),t.OEk(17),t.C$Y(),t.I0R(18,"nz-descriptions-item",21),t.OEk(19),t.C$Y(),t.I0R(20,"nz-descriptions-item",22),t.OEk(21),t.C$Y(),t.I0R(22,"nz-descriptions-item",23),t.OEk(23),t.C$Y(),t.I0R(24,"nz-descriptions-item",24),t.OEk(25),t.C$Y(),t.I0R(26,"nz-descriptions-item",25),t.OEk(27),t.C$Y(),t.I0R(28,"nz-descriptions-item",26),t.OEk(29),t.C$Y(),t.yuY(30,U,3,1,"nz-descriptions-item",27),t.I0R(31,"nz-descriptions-item",28),t.OEk(32),t.C$Y(),t.I0R(33,"nz-descriptions-item",29),t.OEk(34),t.C$Y(),t.I0R(35,"nz-descriptions-item",30),t.OEk(36),t.C$Y()()()(),t.I0R(37,"div",9)(38,"div",10)(39,"table",31)(40,"tr")(41,"th"),t.OEk(42,"Payment No."),t.C$Y(),t.I0R(43,"th"),t.OEk(44,"Due Date"),t.C$Y(),t.I0R(45,"th"),t.OEk(46,"Amount Due"),t.C$Y(),t.I0R(47,"th"),t.OEk(48,"Penalty (days)"),t.C$Y(),t.I0R(49,"th"),t.OEk(50,"Penalty (amount)"),t.C$Y(),t.I0R(51,"th"),t.OEk(52,"Status"),t.C$Y(),t.I0R(53,"th"),t.OEk(54,"Action"),t.C$Y()(),t.yuY(55,H,18,10,"tr",32),t.C$Y()()(),t.k70()),2&e){const n=t.GaO();t.yG2(5),t.oRS("",null==n.loan?null:n.loan.referenceNumber," "),t.yG2(2),t.oRS("\u20b1",n.formatCurrency(null==n.loan?null:n.loan.loanAmount),""),t.yG2(2),t.oRS("","RealEstate"==(null==n.loan?null:n.loan.collateral)?"Real Estate Mortgage":"Chattel Mortgage"," "),t.yG2(2),t.oRS("",null==n.loan?null:n.loan.term," days "),t.yG2(2),t.cNF(null==n.loan?null:n.loan.modeOfPayment),t.yG2(2),t.cNF(null==n.loan?null:n.loan.bank),t.yG2(2),t.oRS("",n.float(null==n.loan?null:n.loan.interest),"% "),t.yG2(2),t.cNF(null==n.loan?null:n.loan.dateGranted),t.yG2(2),t.cNF(null==n.loan?null:n.loan.dueDate),t.yG2(2),t.cNF(null==n.loan?null:n.loan.kindOfLoan),t.yG2(2),t.cNF(null==n.loan?null:n.loan.coMakerName),t.yG2(2),t.oRS("",null==n.loan?null:n.loan.coMakerContact," "),t.yG2(2),t.oRS("",null==n.loan?null:n.loan.coMakerAddress," "),t.yG2(),t.E7m("ngIf","PDC"==(null==n.loan?null:n.loan.modeOfPayment)),t.yG2(2),t.oRS("",null!=n.loan&&n.loan.vatStatus?"Applied":"NA"," "),t.yG2(2),t.oRS("",null!=n.loan&&n.loan.mortStatus?"Applied":"NA"," "),t.yG2(2),t.oRS("",null!=n.loan&&n.loan.notaryFeeStatus?"Applied":"NA"," "),t.yG2(19),t.E7m("ngForOf",n.schedules)}}const J=[{path:"",component:E,children:[{path:"",pathMatch:"full",component:(()=>{class e{appService;loanService;paymentService;borrowerService;dialogService;toastService;datePipe;constructor(n,a,o,m,y,I,z){this.appService=n,this.loanService=a,this.paymentService=o,this.borrowerService=m,this.dialogService=y,this.toastService=I,this.datePipe=z}borrowers;borrower=0;loan;payments=[];schedules=[];computation;monthly;monthlyamount;ngOnInit(){this.getBorrowers(),this.getPermissions()}permissions;getPermissions(){this.permissions=this.appService.getPermissions()}getBorrowers(){this.borrowerService.getList(null,null,!0).subscribe({next:n=>{this.borrowers=n.data}})}getLoanDetails(n){this.loanService.getList({borrowerId:n,status:"Active"}).subscribe({next:a=>{a.data.length>0?(this.loan=a.data[0],this.getPayments(),setTimeout(()=>{this.getPaymentDues()},250)):this.loan=null}})}getPayments(){this.paymentService.getList({loanId:this.loan.id},null,!0).subscribe({next:n=>{this.payments=n.data}})}openPayment(n){this.dialogService.managePayments({loan:this.loan,schedule:n,payment:"full"}).afterClose.subscribe({next:o=>{o.data&&this.getLoanDetails(this.borrower)}})}confirmPayment(n){this.dialogService.confirm("CONFIRM PAYMENT","Are you sure to confirm this payment?").afterClose.subscribe({next:a=>{if(a.data){const o={loanId:this.loan.id,paymentAmount:n.amountDue,dueAmount:n.amountDue,penaltyAmount:0,dueDate:this.datePipe.transform(n.dueDate,"yyyy-MM-dd"),penaltyDays:0,details:{modeOfPayment:"Cheque",account:this.loan.bank,transactionNumber:n.checkNo,amount:n.amountDue},status:"Paid"};this.paymentService.create(o).subscribe({next:m=>{this.toastService.show("success","Payments",m.message),this.getLoanDetails(this.borrower)}})}}})}restructurePayment(n){this.dialogService.managePayments({loan:this.loan,schedule:n,payment:"restructure"}).afterClose.subscribe({next:o=>{}})}getPaymentDues(){const n=this.loan.loanAmount,o=n*(this.loan.interest*(this.loan.term/("Semi-Monthly"==this.loan.paymentTerms?15:30))/100),m=o*(this.loan.vatStatus?.12:0),y=n*(this.loan.mortStatus?.012:0),I=this.loan.notaryFeeStatus?250:0,z=Math.round(100*(o+m+y+I))/100;this.computation={loanAmount:n,interest:o,vat:m,docStamps:y,notary:I,deduction:z,net:n-z},this.monthly=n/(this.loan.term/("Semi-Monthly"==this.loan.paymentTerms?15:30)),this.monthlyamount=String(n/(this.loan.term/("Semi-Monthly"==this.loan.paymentTerms?15:30)));const M=new Date(this.loan.dateGranted),$=[];for(let P=1;P<=this.loan.term/("Semi-Monthly"==this.loan.paymentTerms?15:30);P++){const nt="Semi-Monthly"==this.loan.paymentTerms?15:30,N=this.datePipe.transform(M.setDate(M.getDate()+nt),"MM/dd/yyyy"),k=this.dateDifference(N),A=.04*this.monthly,st=k>0?(.01*this.monthly/30+A/30)*k+A+.12*A:0,D=this.payments.find(rt=>this.datePipe.transform(rt.dueDate,"yyyy-MM-dd")==this.datePipe.transform(N,"yyyy-MM-dd"));$.push({checkNo:this.loan.chequeNumbers.length>0?this.loan.chequeNumbers[P-1]:"",dueDate:N,amountDue:this.monthlyamount,penaltyDays:k,penaltyFee:st,status:D?D.status:"Unpaid"})}this.schedules=$}formatCurrency(n){if(n&&Number(n)>=0){const a=String(n).split("."),o=a[0].replace(/\B(?=(\d{3})+(?!\d))/g,",");let m=".00";return a[1]&&(m="."+a[1].substring(0,2).padEnd(2,"0")),o+m}return 0}dateDifference(n){var a=new Date,o=new Date(n),m=a.getTime()-o.getTime();return m>0?Math.ceil(Math.abs(m)/864e5):0}float(n){return parseFloat(n)}static \u0275fac=function(a){return new(a||e)(t.GI1(g.ye),t.GI1(g.If),t.GI1(O.E),t.GI1(S.K),t.GI1(T.E),t.GI1(g.s9),t.GI1(b.y))};static \u0275cmp=t.In1({type:e,selectors:[["app-payments"]],decls:10,vars:5,consts:[[1,"px-2.5"],["nz-row",""],["nz-col","","nzSpan","8"],["nzShowSearch","","nzAllowClear","",1,"w-full",3,"ngModel","ngModelChange"],[3,"nzValue","nzLabel",4,"ngFor","ngForOf"],["nz-row","","class","mt-5",4,"ngIf"],["nz-row","",4,"ngIf"],[4,"ngIf"],[3,"nzValue","nzLabel"],["nz-row","",1,"mt-5"],["nz-col","","nzSpan","24"],[1,"text-center"],["nz-icon","","nzType","warning","nzTheme","outline",1,"text-9xl"],["nzBordered","","nzSize","small"],["nzTitle","Reference Number","nzSpan","3"],["nzTitle","Loan Amount"],["nzTitle","Collateral"],["nzTitle","Terms of days"],["nzTitle","Mode Of Payment"],["nzTitle","Bank"],["nzTitle","Interest"],["nzTitle","Date Granted"],["nzTitle","Due Date"],["nzTitle","Kind Of Loan"],["nzTitle","Co-Maker"],["nzTitle","Co-Maker Contact No."],["nzTitle","Co-Maker Address"],["nzTitle","Check Nos.","nzSpan","2",4,"ngIf"],["nzTitle","VAT (DS(PN)) - 12%"],["nzTitle","DS(Mort.) - 1.2%"],["nzTitle","Notary Fee - \u20b1250"],[1,"w-full"],[4,"ngFor","ngForOf"],["nzTitle","Check Nos.","nzSpan","2"],["nz-col","","nzSpan","6",4,"ngFor","ngForOf"],["nz-col","","nzSpan","6"],[1,"flex","justify-center"],["nz-button","","nzType","primary","class","mx-1",3,"disabled","click",4,"ngIf"],["nz-button","","nzType","primary","class","mx-1",4,"ngIf"],["nz-button","","nzType","primary",1,"mx-1",3,"disabled","click"],["nz-button","","nzType","primary",1,"mx-1"]],template:function(a,o){1&a&&(t.I0R(0,"div",0)(1,"div",1)(2,"div",2)(3,"h5"),t.OEk(4,"Search Borrower:"),t.C$Y(),t.I0R(5,"nz-select",3),t.iHE("ngModelChange",function(y){return t.kNx(o.borrower,y)||(o.borrower=y),y}),t.qCj("ngModelChange",function(){return o.getLoanDetails(o.borrower)}),t.yuY(6,F,1,2,"nz-option",4),t.C$Y()()(),t.yuY(7,L,6,0,"div",5)(8,B,5,0,"div",6)(9,X,56,18,"ng-container",7),t.C$Y()),2&a&&(t.yG2(5),t.OKB("ngModel",o.borrower),t.yG2(),t.E7m("ngForOf",o.borrowers),t.yG2(),t.E7m("ngIf",0==o.borrower),t.yG2(),t.E7m("ngIf",o.borrower>0&&!o.loan),t.yG2(),t.E7m("ngIf",o.borrower>0&&o.loan))},dependencies:[b.ay,b.u_,R.Ez,_.k,G.o9,u.If,i.QD,i.ox,l.eE,l.Mh,d.Qx,d.oF,h.y6,h.Gk,h.G0,Y.ue,Y._G]})}return e})(),data:{breadcrumb:C.m.PAYMENT}}]}];let W=(()=>{class e{static \u0275fac=function(a){return new(a||e)};static \u0275mod=t.a4G({type:e});static \u0275inj=t.s3X({imports:[c.qQ.forChild(J),c.qQ]})}return e})();var Z=r(4744);let q=(()=>{class e{static \u0275fac=function(a){return new(a||e)};static \u0275mod=t.a4G({type:e});static \u0275inj=t.s3X({imports:[b.MD,W,f.k,Z.cP.forChild()]})}return e})()},1296:(x,v,r)=>{r.d(v,{a:()=>G});var b=r(1528),f=r(940),c=r(1780);const C=u=>{const i=[{label:"Home",url:c.o.APP.BASE}];switch(u){case c.m.DASHBOARD:i.push({label:"Dashboard"});break;case c.m.LOAN:i.push({label:"Loan"});break;case c.m.LOAN_DETAILS:i.push({label:"Loan",url:c.o.APP.LOAN},{label:"Details"});break;case c.m.PAYMENT:i.push({label:"Payment"});break;case c.m.EXPENSES:i.push({label:"Expenses"});break;case c.m.REPORTS:i.push({label:"Reports"});break;case c.m.ACCOUNT:i.push({label:"Account Settings"});break;case c.m.ACCOUNTS_USERS:i.push({label:"Accounts"},{label:"Users"});break;case c.m.ACCOUNTS_ROLES:i.push({label:"Accounts"},{label:"Roles"});break;case c.m.ACCOUNTS_ROLES:i.push({label:"Accounts"},{label:"Borrowers"});break;case c.m.MAINTENANCE_INTEREST:i.push({label:"Maintenance"},{label:"Interests"});break;case c.m.MAINTENANCE_TERM:i.push({label:"Maintenance"},{label:"Terms"});break;case c.m.MAINTENANCE_COLLATERAL:i.push({label:"Maintenance"},{label:"Collaterals"});break;case c.m.MAINTENANCE_BANK:i.push({label:"Maintenance"},{label:"Banks"});break;case c.m.OTHERS_SEX:i.push({label:"Others"},{label:"Sex"});break;case c.m.OTHERS_CIVIL_STATUS:i.push({label:"Others"},{label:"Civil Status"})}return i};var t=r(6684),s=r(4496),E=r(1368),g=r(3064),O=r(6088);function S(u,i){if(1&u&&(s.I0R(0,"span",6),s.OEk(1),s.C$Y()),2&u){const l=s.GaO().$implicit;s.yG2(),s.cNF(l.label)}}function T(u,i){if(1&u&&(s.I0R(0,"span",6),s.OEk(1),s.C$Y()),2&u){const l=s.GaO().$implicit,d=s.GaO();s.yG2(),s.cNF(d.label?d.label:l.label)}}function R(u,i){1&u&&(s.I0R(0,"div",7),s.wR5(1,"i",8),s.C$Y())}function _(u,i){if(1&u&&(s.I0R(0,"div",3),s.yuY(1,S,2,1,"span",4)(2,T,2,1,"span",4)(3,R,2,0,"div",5),s.C$Y()),2&u){const l=i.$implicit,d=i.last,h=i.first;s.uQ9("flex align-center ",h?"first":"",""),s.eAK("last",d)("first",h||l.url),s.E7m("routerLink","/"+l.url),s.yG2(),s.E7m("ngIf",!d),s.yG2(),s.E7m("ngIf",d),s.yG2(),s.E7m("ngIf",!d)}}let G=(()=>{class u{route;router;label;updateBreadcrumbEvent;breadcrumbs;eventSubscription;constructor(l,d){this.route=l,this.router=d}ngOnInit(){var l=this;this.configureBreadcrumb(),this.updateBreadcrumbEvent&&(this.eventSubscription=this.updateBreadcrumbEvent.subscribe((0,b.c)(function*(){yield l.configureBreadcrumb()}))),this.initializeBreadcrumb()}configureBreadcrumb(){this.router.events.pipe((0,t.I)(l=>l instanceof f.MT)).subscribe(()=>{this.route.firstChild&&this.route.firstChild.data.subscribe(l=>{this.breadcrumbs=C(l.breadcrumb)})})}initializeBreadcrumb(){this.route.firstChild?this.route.firstChild.data.subscribe(l=>{this.breadcrumbs=C(l.breadcrumb)}):this.route.data.subscribe(l=>{this.breadcrumbs=C(l.breadcrumb)})}static \u0275fac=function(d){return new(d||u)(s.GI1(f.gV),s.GI1(f.E5))};static \u0275cmp=s.In1({type:u,selectors:[["app-breadcrumb"]],inputs:{label:"label",updateBreadcrumbEvent:"updateBreadcrumbEvent"},decls:3,vars:1,consts:[[1,"w-full","pt-1","pl-3"],[1,"flex","justify-start"],[3,"class","last","first","routerLink",4,"ngFor","ngForOf"],[3,"routerLink"],["class","label",4,"ngIf"],["class","flex mx-1 self-center",4,"ngIf"],[1,"label"],[1,"flex","mx-1","self-center"],["nz-icon","","nzType","right","nzTheme","outline"]],template:function(d,h){1&d&&(s.I0R(0,"div",0)(1,"div",1),s.yuY(2,_,4,11,"div",2),s.C$Y()()),2&d&&(s.yG2(2),s.E7m("ngForOf",h.breadcrumbs))},dependencies:[E.ay,E.u_,g.k,O.If,f.ER],styles:[".first[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{cursor:pointer;color:#0064c8}"]})}return u})()}}]);